<!DOCTYPE html>
<html>
<head>
    <title>ホーム</title>
    <link rel="stylesheet" type="text/css" href="/static/css/home.css">
    <script>
        const current_user_name = "{{ username }}";
        const page_language = "jp";
    </script>
</head>
<body>
    <div class="header-container">
        <h1>ようこそ, {{ username }}さん!</h1>
        <form action="/logout" method="post">
            <input type="submit" value="ログアウト">
            <input type="hidden" name="lang" value="jp">
        </form>
        {% if role == 'sysadmin' %}
        <nav>
            <a href="/passwd-jp?username={{ username }}&role={{ role }}&password={{ password }}">パスワード変更</a>
            <a href="/useradmin-jp?username={{ username }}&role={{ role }}&password={{ password }}">ユーザー作成・削除</a>
            <a href="/project-jp?username={{ username }}&role={{ role }}&password={{ password }}">プロジェクト作成</a>
            <a href="/user-jp?username={{ username }}&role={{ role }}&password={{ password }}">ユーザー情報</a>
        </nav>
        {% endif %}
        <a class="JPpage" href="/home?username={{ username }}&role={{ role }}&password={{ password }}">英語</a>
    </div>

    <div class="container">
        <script>
            alert("ログインに成功しました！")
        </script>
        {% if role == 'sysadmin' %}
            <p>あなたはシステム管理者です。</p>
        {% endif %}

        {% if role == 'hiruchaaru' %}
            <p>貴方はヒルチャールです。</p>
            <h2>ヒルチャールのお兄さんが病気になった♪</h2>
            <h2>ヒルチャールのお姉さんが看病して♪</h2>
            <h2>ヒルチャールのお兄さんが薬を飲んでも治らない♪</h2>
            <a>※原神のネタです。</a>

            <p>登録プロジェクトを表示：</p>

            <button id="hrc_show-attendances-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">プロジェクト表示</button>
            <button id="hrc_hide-attendances-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px; display: none;">プロジェクト隠す</button>
            
            <input type="text" id="filter-input" placeholder="高性能フェルータ" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>
            
            <ul id="attendance-list" style="display: none;">
                <!-- 出席リストがここに表示されます -->
            </ul>

            <p>タスクを表示:</p>

            <button id="hrctsk-show-tasks-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">タスク表示</button>
            <button id="hrctsk-hide-tasks-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px; display: none;">タスク隠す</button>

            <input type="text" id="hrctsk-filter-input" placeholder="高性能フェルータ" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>

            <ul id="hrctsk-task-list" style="display: none;">
                <!-- タスクリストがここに表示されます -->
            </ul>

            <div id="hrctsk-edit-task-modal" style="display: none;">
                <p>タスク編集：</p>
                <form id="hrctsk-edit-task-form">
                    <label for="hrctsk-edit-status">詳細情報：</label>
                    <textarea id="hrctsk-edit-status" rows="4"></textarea><br>

                    <label for="hrctsk-edit-task-progress">進行度：</label>
                    <input type="number" id="hrctsk-edit-task-progress" name="pmtsk-edit-task-progress" min="0" max="100" required><br>


                    <button type="submit" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">保存</button>
                    <button type="button" id="hrctsk-cancel-edit" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">キャンセル</button>
                </form>
            </div>
            

        {% endif %}

        {% if role == 'projectmanager' %}
            <p>貴方はプロジェクトマネージャーです</p>
            <p>プロジェクト閲覧：</p>

            <button id="show-projects-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">プロジェクト表示</button>
            <button id="hide-projects-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px; display: none;">プロジェクト隠す</button>
            
            <input type="text" id="filter-input" placeholder="高性能フェルータ" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>
            
            <ul id="project-list" style="display: none;">
                <!-- プロジェクトリストがここに表示されます -->
            </ul>

            <div id="edit-project-modal" style="display: none;">
                <p>プロジェクト編集：</p>
                <form id="edit-project-form">
                    <label for="edit-name">プロジェクト名：</label>
                    <input type="text" id="edit-name" required><br>

                    <label for="edit-description">プロジェクト詳細：</label>
                    <textarea id="edit-description" rows="4" required></textarea><br>

                    <label for="edit-starttime">開始日時：</label>
                    <input type="datetime-local" id="edit-starttime" required><br>

                    <label for="edit-endtime">終了日時</label>
                    <input type="datetime-local" id="edit-endtime" required><br>

                    <label for="edit-status">状態：</label>
                    <select id="edit-status" required>
                        <option value="scheduled">予定</option>
                        <option value="ongoing">進行中</option>
                        <option value="Requirements_Definition">要件定義</option>
                        <option value="Basic_Design">基本設計</option>
                        <option value="Detailed_Design">詳細設計</option>
                        <option value="Programming">プログラミング</option>
                        <option value="Unit_Testing">単体テスト</option>
                        <option value="Integration_Testing">結合テスト</option>
                        <option value="System_Testing">システムテスト</option>
                    </select><br>

                    <button type="submit" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">保存</button>
                    <button type="button" id="cancel-edit" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">取り消す</button>

                </form>
            </div>

            <p>プロジェクトをユーザーに割り当てます：</p>
            <p>本日以前の出席記録は追加されません。</p>
            <p>編集によってプロジェクトの日付が変更された場合、出席記録もそれに応じて更新されます。</p>
            <!--今日より前の出勤記録は登録できないぞ！-->
            <form action="/pm_create_attendance" method="post">
                <input type="hidden" name="username" value="{{ username }}">
                <input type="hidden" name="role" value="{{ role }}">
                <input type="hidden" name="password" value="{{ password }}">
                <input type="hidden" name="lang" value="jp">

                <label for="pmasu_the_project_name">プロジェクト名：</label>
                <select id="pmasu_the_project_name" name="pmasu_the_project_name" required>
                    <option value="">プロジェクトを選択してください</option>
                </select>
            
                <label for="pmasu_the_user_name">ユーザー名：</label>
                <select id="pmasu_the_user_name" name="pmasu_the_user_name" required>
                    <option value="">ユーザーを選択してください</option>
                </select>

                <input type="submit" value="割り当て">
            </form>
            {% if pm_createattendance_message %}
                <div class="message {% if pm_createattendance_success %}success{% else %}error{% endif %}">
                    {{ pm_createattendance_message }}
                </div>
            {% endif %}

            <p>ユーザーへのプロジェクトの割り当てを解除します：</p>
            <form action="/pm_delete_attendance" method="post">
                <input type="hidden" name="username" value="{{ username }}">
                <input type="hidden" name="role" value="{{ role }}">
                <input type="hidden" name="password" value="{{ password }}">
                <input type="hidden" name="lang" value="jp">

                <label for="pmuasu_the_project_name">プロジェクト名：</label>
                <select id="pmuasu_the_project_name" name="pmuasu_the_project_name" required>
                    <option value="">プロジェクトを選択してください</option>
                </select>

                <label for="pmuasu_the_user_name">ユーザー名：</label>
                <select id="pmuasu_the_user_name" name="pmuasu_the_user_name" required>
                    <option value="">ユーザーを選択してください</option>
                </select>

                <input type="submit" value="割り当て解除">
            </form>
            {% if pm_deleteattendance_message %}
                <div class="message {% if pm_deleteattendance_success %}success{% else %}error{% endif %}">
                    {{ pm_deleteattendance_message }}
                </div>
            {% endif %}


            <p>出勤情報：</p>

            <button id="pmat_show-attendances-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">出勤情報表示</button>
            <button id="pmat_hide-attendances-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px; display: none;">出勤情報隠す</button>
            
            <input type="text" id="attendance-and-filterA" placeholder="論理積フェルータ" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>
            <input type="text" id="attendance-and-filterB" placeholder="論理積フェルータ" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>
            <input type="text" id="attendance-and-filterC" placeholder="論理積フェルータ" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>
            <input type="text" id="attendance-filter-date-before" placeholder="この日の前" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>
            <input type="text" id="attendance-filter-date-after" placeholder="この日の後" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>

            <button id="calculate-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px; display: none;">出勤率計算</button>
            
            <p id="calculate-output" style="display: none;">This feature is not implemented yet.</p>

            <ul id="attendance-list" style="display: none;">
                <!-- 出席リストがここに表示されます -->
            </ul>
            

            <p>新しいタスクを作成する:</p>
            <form id="pmcreateTaskForm" action="/pm_create_task" method="post">
                <input type="hidden" name="username" value="{{ username }}">
                <input type="hidden" name="role" value="{{ role }}">
                <input type="hidden" name="password" value="{{ password }}">
                <input type="hidden" name="lang" value="jp">

                <label for="pmcreatetask_the_project_name">プロジェクト名:</label>
                <!-- <input type="text" id="pmcreatetask_the_project_name" name="pmcreatetask_the_project_name" required> -->
                <select id="pmcreatetask_the_project_name" name="pmcreatetask_the_project_name" required>
                    <option value="">プロジェクトを選択してください</option>
                </select>

                <!-- <label for="pmcreatetask_the_user_names">ユーザー名(カンマで区切って複数記入可):</label>
                <input type="text" id="pmcreatetask_the_user_names" name="pmcreatetask_the_user_names" required> -->

                <label for="pmcreatetask_the_user_names">ユーザー選択：</label>
                <div id="pmcreatetask_the_user_names">
                    <!-- ユーザーのチェックボックスがここに挿入されます -->
                </div>
                
                <input type="hidden" id="pmcreatetask_user_list" name="pmcreatetask_the_user_names" value="">

                <label for="the_task_startdate">タスク開始日:</label>
                <input type="date" id="the_task_startdate" name="the_task_startdate" required>

                <label for="the_task_enddate">タスク終了日:</label>
                <input type="date" id="the_task_enddate" name="the_task_enddate" required>

                <label for="the_task_status">タスクの説明 (任意):</label>
                <textarea id="the_task_status" name="the_task_status" rows="6" style="width: 100%;" 
                    placeholder="砂糖を7個作る：40%完成&#10;ヒルチャールA：3個完成&#10;ヒルチャールB：1個完成、2個紛失&#10;ヒルチャールC：道端で勇者と出会い、死亡確認中"></textarea>

                <input type="submit" value="送信">
            </form>

            {% if pm_createtask_message %}
                <div class="message {% if pm_createtask_success %}success{% else %}error{% endif %}">
                    {{ pm_createtask_message }}
                </div>
            {% endif %}

            <p>⚠️タスクに関する警告：</p>

            <p>タスクを表示:</p>

            <button id="pmtsk-show-tasks-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">タスク表示</button>
            <button id="pmtsk-hide-tasks-btn" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px; display: none;">タスク隠す</button>

            <input type="text" id="pmtsk-filter-input" placeholder="高性能フェルータ" style="margin-top: 10px; padding: 8px; width: 200px; display: none;"/>

            <ul id="pmtsk-task-list" style="display: none;">
                <!-- タスクリストがここに表示されます -->
            </ul>

            <div id="pmtsk-edit-task-modal" style="display: none;">
                <p>タスク編集：</p>
                <form id="pmtsk-edit-task-form">
                    <!-- <label for="pmtsk-edit-project">Project Name:</label>
                    <input type="text" id="pmtsk-edit-project" required><br> -->

                    <label for="pmtsk-edit-user">ユーザー名：</label>
                    <input type="text" id="pmtsk-edit-user" required><br>

                    <label for="pmtsk-edit-startdate">開始日：</label>
                    <input type="date" id="pmtsk-edit-startdate" required><br>

                    <label for="pmtsk-edit-enddate">終了日：</label>
                    <input type="date" id="pmtsk-edit-enddate" required><br>

                    <label for="pmtsk-edit-status">詳細情報：</label>
                    <textarea id="pmtsk-edit-status" rows="4" ></textarea><br>

                    <label for="pmtsk-edit-task-progress">進行度：</label>
                    <input type="number" id="pmtsk-edit-task-progress" name="pmtsk-edit-task-progress" min="0" max="100" required><br>

                    <button type="submit" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">保存</button>
                    <button type="button" id="pmtsk-cancel-edit" style="background-color: #333; border: none; color: white; padding: 9px 30px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; margin: 4px 2px; cursor: pointer; border-radius: 4px;">キャンセル</button>
                </form>
            </div>


        {% endif %}

        {% if error %}
            <div class="message error">
                {{ error }}
            </div>
        {% endif %}
    </div>

    <script src="/static/js/home.js"></script>
</body>
</html>
